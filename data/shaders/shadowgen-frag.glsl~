#ifdef GL_ES
precision mediump float;  
#endif
uniform float invFar; //   actually this is inverse of distance from camera to frustum corner
const vec4 bitShift = vec4( 256.0, 1.0, 256.0, 1.0);
const vec4 bitMask = vec4(0.0, 1.0 / 256.0, 0.0, 1.0 / 256.0);
varying vec3 pos;

void main() {
	float depth = length(pos) * invFar;			 
	float moment2 = depth * depth;		
	vec4 comp = fract(vec4(depth, depth, moment2, moment2) * bitShift);
	gl_FragColor = comp - comp.xxzz * bitMask; //this give more precission	
}
